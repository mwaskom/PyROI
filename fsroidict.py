from numpy import floor

def Rois(vol,space='volume'):
    """Takes a name of a volume or surface and optionally an argument 
    specifying the space of the first argument.  Returns a dictionary
    of ids and names of the Rois in the vol or surf.  If surface is 
    specified as the space, it returns the ids in "reduced" form to 
    match the way annotations are handled

    =======
    Returns: dictionary

    """
    
    rois = {10: 'Left-Thalamus-Proper',
            11: 'Left-Caudate',
            12: 'Left-Putamen',
            13: 'Left-Pallidum',
            17: 'Left-Hippocampus',
            18: 'Left-Amygdala',
            26: 'Left-Accumbens-area',
            28: 'Left-VentralDC',
            49: 'Right-Thalamus-Proper',
            50: 'Right-Caudate',
            51: 'Right-Putamen',
            52: 'Right-Pallidum',
            53: 'Right-Hippocampus',
            54: 'Right-Amygdala',
            58: 'Right-Accumbens-area',
            60: 'Right-VentralDC',
            
            1001: 'lh-bankssts',
            1002: 'lh-caudalanteriorcingulate',
            1003: 'lh-caudalmiddlefrontal',
            1004: 'lh-corpuscallosum',
            1005: 'lh-cuneus',
            1006: 'lh-entorhinal',
            1007: 'lh-fusiform',
            1008: 'lh-inferiorparietal',
            1009: 'lh-inferiortemporal',
            1010: 'lh-isthmuscingulate',
            1011: 'lh-lateraloccipital',
            1012: 'lh-lateralorbitofrontal',
            1013: 'lh-lingual',
            1014: 'lh-medialorbitofrontal',
            1015: 'lh-middletemporal',
            1016: 'lh-parahippocampal',
            1017: 'lh-paracentral',
            1018: 'lh-parsopercularis',
            1019: 'lh-parsorbitalis',
            1020: 'lh-parstriangularis',
            1021: 'lh-pericalcarine',
            1022: 'lh-postcentral',
            1023: 'lh-posteriorcingulate',
            1024: 'lh-precentral',
            1025: 'lh-precuneus',
            1026: 'lh-rostralanteriorcingulate',
            1027: 'lh-rostralmiddlefrontal',
            1028: 'lh-superiorfrontal',
            1029: 'lh-superiorparietal',
            1030: 'lh-superiortemporal',
            1031: 'lh-supramarginal',
            1032: 'lh-frotnalpole',
            1033: 'lh-temporalpole',
            1034: 'lh-transversetemporal',
            1035: 'lh-insula',
            
            2001: 'rh-bankssts',
            2002: 'rh-caudalanteriorcingulate',
            2003: 'rh-caudalmiddlefrontal',
            2004: 'rh-corpuscallosum',
            2005: 'rh-cuneus',
            2006: 'rh-entrohinal',
            2007: 'rh-fusifrom',
            2008: 'rh-inferiorparietal',
            2009: 'rh-inferiortemporal',
            2010: 'rh-isthmuscingulate',
            2011: 'rh-lateraloccipital',
            2012: 'rh-lateralorbitalfrontal',
            2013: 'rh-lingual',
            2014: 'rh-medialorbitofrontal',
            2015: 'rh-middletemporal',
            2016: 'rh-parahippocampal',
            2017: 'rh-paracentral',
            2018: 'rh-parsopercularis',
            2019: 'rh-parsorbitalis',
            2020: 'rh-parstriangularis',
            2021: 'rh-pericalcarine',
            2022: 'rh-postcentral',
            2023: 'rh-posteriorcingulate',
            2024: 'rh-precentral',
            2025: 'rh-precuneus',
            2026: 'rh-rostralanteriorcingulate',
            2027: 'rh-rostralmiddlefrontal',
            2028: 'rh-superiorfrontal',
            2029: 'rh-superiorparietal',
            2030: 'rh-superiortemporal',
            2031: 'rh-supramarginal',
            2032: 'rh-frontalpole',
            2033: 'rh-temporalpole',
            2034: 'rh-transversetemporal',
            2035: 'rh-insula',
            
            11101: 'lh_G_and_S_frontomargin',
            11102: 'lh_G_and_S_occipital_inf',
            11103: 'lh_G_and_S_paracentral',
            11104: 'lh_G_and_S_subcentral',
            11105: 'lh_G_and_S_transv_frontopol',
            11106: 'lh_G_and_S_cingul-Ant',
            11107: 'lh_G_and_S_cingul-Mid-Ant',
            11108: 'lh_G_and_S_cingul-Mid-Post',
            11109: 'lh_G_cingul-Post-dorsal',
            11110: 'lh_G_cingul-Post-ventral',
            11111: 'lh_G_cuneus',
            11112: 'lh_G_front_inf-Opercular',
            11113: 'lh_G_front_inf-Orbital',
            11114: 'lh_G_front_inf-Triangul',
            11115: 'lh_G_front_middle',
            11116: 'lh_G_front_sup',
            11117: 'lh_G_Ins_lg_and_S_cent_ins',
            11118: 'lh_G_insular_short',
            11119: 'lh_G_occipital_middle',
            11120: 'lh_G_occipital_sup',
            11121: 'lh_G_oc-temp_lat-fusifor',
            11122: 'lh_G_oc-temp_med-Lingual',
            11123: 'lh_G_oc-temp_med-Parahip',
            11124: 'lh_G_orbital',
            11125: 'lh_G_pariet_inf-Angular',
            11126: 'lh_G_pariet_inf-Supramar',
            11127: 'lh_G_parietal_sup',
            11128: 'lh_G_postcentral',
            11129: 'lh_G_precentral',
            11130: 'lh_G_precuneus',
            11131: 'lh_G_rectus',
            11132: 'lh_G_subcallosal',
            11133: 'lh_G_temp_sup-G_T_transv',
            11134: 'lh_G_temp_sup-Lateral',
            11135: 'lh_G_temp_sup-Plan_polar',
            11136: 'lh_G_temp_sup-Plan_tempo',
            11137: 'lh_G_temporal_inf',
            11138: 'lh_G_temporal_middle',
            11139: 'lh_Lat_Fis-ant-Horizont',
            11140: 'lh_Lat_Fis-ant-Vertical',
            11141: 'lh_Lat_Fis-post',
            11142: 'lh_Medial_wall',
            11143: 'lh_Pole_occipital',
            11144: 'lh_Pole_temporal',
            11145: 'lh_S_calcarine',
            11146: 'lh_S_central',
            11147: 'lh_S_cingul-Marginalis',
            11148: 'lh_S_circular_insula_ant',
            11149: 'lh_S_circular_insula_inf',
            11150: 'lh_S_circular_insula_sup',
            11151: 'lh_S_collat_transv_ant',
            11152: 'lh_S_collat_transv_post',
            11153: 'lh_S_front_inf',
            11154: 'lh_S_front_middle',
            11155: 'lh_S_front_sup',
            11156: 'lh_S_interm_prim-Jensen',
            11157: 'lh_S_intrapariet_and_P_trans',
            11158: 'lh_S_oc_middle_and_Lunatus',
            11159: 'lh_S_oc_sup_and_transversal',
            11160: 'lh_S_occipital_ant',
            11161: 'lh_S_oc-temp_lat',
            11162: 'lh_S_oc-temp_med_and_Lingual',
            11163: 'lh_S_orbital_lateral',
            11164: 'lh_S_orbital_med-olfact',
            11165: 'lh_S_orbital-H_Shaped',
            11166: 'lh_S_parieto_occipital',
            11167: 'lh_S_pericallosal',
            11168: 'lh_S_postcentral',
            11169: 'lh_S_precentral-inf-part',
            11170: 'lh_S_precentral-sup-part',
            11171: 'lh_S_suborbital',
            11172: 'lh_S_subparietal',
            11173: 'lh_S_temporal_inf',
            11174: 'lh_S_temporal_sup',
            11175: 'lh_S_temporal_transverse',
            
            
            12101: 'rh_G_and_S_frontomargin',
            12102: 'rh_G_and_S_occipital_inf',
            12103: 'rh_G_and_S_paracentral',
            12104: 'rh_G_and_S_subcentral',
            12105: 'rh_G_and_S_transv_frontopol',
            12106: 'rh_G_and_S_cingul-Ant',
            12107: 'rh_G_and_S_cingul-Mid-Ant',
            12108: 'rh_G_and_S_cingul-Mid-Post',
            12109: 'rh_G_cingul-Post-dorsal',
            12110: 'rh_G_cingul-Post-ventral',
            12111: 'rh_G_cuneus',
            12112: 'rh_G_front_inf-Opercular',
            12113: 'rh_G_front_inf-Orbital',
            12114: 'rh_G_front_inf-Triangul',
            12115: 'rh_G_front_middle',
            12116: 'rh_G_front_sup',
            12117: 'rh_G_Ins_lg_and_S_cent_ins',
            12118: 'rh_G_insular_short',
            12119: 'rh_G_occipital_middle',
            12120: 'rh_G_occipital_sup',
            12121: 'rh_G_oc-temp_lat-fusifor',
            12122: 'rh_G_oc-temp_med-Lingual',
            12123: 'rh_G_oc-temp_med-Parahip',
            12124: 'rh_G_orbital',
            12125: 'rh_G_pariet_inf-Angular',
            12126: 'rh_G_pariet_inf-Supramar',
            12127: 'rh_G_parietal_sup',
            12128: 'rh_G_postcentral',
            12129: 'rh_G_precentral',
            12130: 'rh_G_precuneus',
            12131: 'rh_G_rectus',
            12132: 'rh_G_subcallosal',
            12133: 'rh_G_temp_sup-G_T_transv',
            12134: 'rh_G_temp_sup-Lateral',
            12135: 'rh_G_temp_sup-Plan_polar',
            12136: 'rh_G_temp_sup-Plan_tempo',
            12137: 'rh_G_temporal_inf',
            12138: 'rh_G_temporal_middle',
            12139: 'rh_Lat_Fis-ant-Horizont',
            12140: 'rh_Lat_Fis-ant-Vertical',
            12141: 'rh_Lat_Fis-post',
            12142: 'rh_Medial_wall',
            12143: 'rh_Pole_occipital',
            12144: 'rh_Pole_temporal',
            12145: 'rh_S_calcarine',
            12146: 'rh_S_central',
            12147: 'rh_S_cingul-Marginalis',
            12148: 'rh_S_circular_insula_ant',
            12149: 'rh_S_circular_insula_inf',
            12150: 'rh_S_circular_insula_sup',
            12151: 'rh_S_collat_transv_ant',
            12152: 'rh_S_collat_transv_post',
            12153: 'rh_S_front_inf',
            12154: 'rh_S_front_middle',
            12155: 'rh_S_front_sup',
            12156: 'rh_S_interm_prim-Jensen',
            12157: 'rh_S_intrapariet_and_P_trans',
            12158: 'rh_S_oc_middle_and_Lunatus',
            12159: 'rh_S_oc_sup_and_transversal',
            12160: 'rh_S_occipital_ant',
            12161: 'rh_S_oc-temp_lat',
            12162: 'rh_S_oc-temp_med_and_Lingual',
            12163: 'rh_S_orbital_lateral',
            12164: 'rh_S_orbital_med-olfact',
            12165: 'rh_S_orbital-H_Shaped',
            12166: 'rh_S_parieto_occipital',
            12167: 'rh_S_pericallosal',
            12168: 'rh_S_postcentral',
            12169: 'rh_S_precentral-inf-part',
            12170: 'rh_S_precentral-sup-part',
            12171: 'rh_S_suborbital',
            12172: 'rh_S_subparietal',
            12173: 'rh_S_temporal_inf',
            12174: 'rh_S_temporal_sup',
            12175: 'rh_S_temporal_transverse'}
   
    minmax = {'full'            :(0,12199),
              'aseg.mgz'        :(0,1000),
              'aparc+aseg.mgz'  :(1000,3000),
              'aparc.a2009s.mgz':(11100,13000),
              'lh.aparc'        :(1000,1999),
              'rh.aparc'        :(2000,2999),
              'lh.aparc.a2009s' :(11100,11199),
              'rh.aparc.a2009s' :(12100,12199)}
   
    
    min = minmax[vol][0]
    max = minmax[vol][1]

    retdict = {}

    for id in rois.keys():
        if min <= id <= max:
            if space == 'surface': retid = int(id-(floor(id/100)*100))
            elif space =='volume': retid = id
            else: raise Exception('Space argument %s not understood' % space)
            retdict[retid] = rois[id]
    return retdict
